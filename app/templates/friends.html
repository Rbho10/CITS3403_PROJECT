{% extends "homebase.html" %}

{% block title %}Friend Profile | ProTrack{% endblock %}

{% block body %}

<!-- Main Content -->
<div class="main-content">

    <!-- Top Navigation -->
    <div class="search-bar">
        <input type="text" id="search-input" placeholder="Search friends..." oninput="searchFriends()">
    </div>

    <div class="friends-list">
        <!-- Add Friend -->
        <div class="add-friend-card">
            <input type="text" class="add-input" placeholder="Enter username...">
            <button class="add-btn">Add Friend</button>
        </div>

    </div>
    <div class="friends-list" id="friends-list">
        <!-- This will be dynamically updated -->
    </div>

</div>


<!--AJAX Script implemented to search for a matching friend's username-->
<script>
function searchFriends() {
    const query = document.getElementById('search-input').value;

    fetch('/search_friends?query=' + encodeURIComponent(query))
    .then(response => response.json())
    .then(data => {
        const friendsList = document.getElementById('friends-list');
        friendsList.innerHTML = ''; // Clear old list

        data.friends.forEach(friend => {
            const card = `
                <div class="friend-card">
                    <div class="friend-info">
                        <div class="friend-avatar"></div>
                        <div class="friend-details">
                            <div class="friend-name">${friend.username}</div>
                        </div>
                    </div>
                    <button class="go-btn">Go To</button>
                </div>
            `;
            friendsList.innerHTML += card;
        });

        if (data.friends.length === 0) {
            friendsList.innerHTML = '<div>No friends found!</div>';
        }
    })
    .catch(error => console.error('Error:', error));
}

// Load initial friends when page first opens
document.addEventListener('DOMContentLoaded', searchFriends);
</script>
{% endblock %}